<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CV Score ‚Äì Free Resume Scoring Tool</title>
  <meta name="description"
    content="Upload your CV to get an instant score. Fast, free resume analyzer powered by AWS Lambda.">
</head>

<body style="font-family: Arial; max-width: 600px; margin: 2rem auto; text-align: center;">
  <h1>CV Score Checker</h1>
  <p>Select your PDF resume to get a score:</p>
  <input type="file" id="cvFile" accept=".pdf" />
  <br />
  <button onclick="uploadCV()">Check Score</button>
  <p id="result" style="margin-top: 20px;"></p>

  <script>
    async function uploadCV() {
      const fileInput = document.getElementById('cvFile');
      const result = document.getElementById('result');
      const file = fileInput.files[0];

      if (!file) {
        result.innerText = "Please select a PDF file.";
        return;
      }

      try {
        // Convert file to Base64
        const arrayBuffer = await file.arrayBuffer();
        const base64Content = btoa(
          new Uint8Array(arrayBuffer).reduce((data, byte) => data + String.fromCharCode(byte), "")
        );

        const payload = {
          fileName: file.name,
          content: base64Content
        };

        // Call API Gateway
        const response = await fetch(
          "https://f7s7vlwioe.execute-api.ap-south-1.amazonaws.com/prod",
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          }
        );

        if (!response.ok) {
          const errorText = await response.text();
          throw new Error(`Server error: ${errorText}`);
        }

        // Parse Lambda proxy response
        const data = await response.json();
        const parsedBody = JSON.parse(data.body);

        // Show a cleaner result
        result.innerHTML = `
        ‚úÖ ${parsedBody.message}<br>
        üìÑ File: ${parsedBody.filename}<br>
        ‚≠ê Score: <b>${parsedBody.score}</b>
      `;
      } catch (error) {
        console.error(error);
        result.innerText = "‚ùå Error: Could not get score. Check console for details.";
      }
    }
  </script>

</body>

</html>
